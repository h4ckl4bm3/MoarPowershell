# Parse Apache combined log format
select-string -path access.log -pattern "(\S+)\s-\s-\s\[([^\]]+)\]\s""(\S+)\s(\S+)\s([^""]+)""\s(\d+)\s(\d+)\s""([^""]+)""\s""([^""]+)""" -allmatches | Select-Object  @{"Name"="IP"; "Expression"={$_.matches[0].Groups[1]}}, @{"Name"="Time"; "Expression"={[DateTime]::ParseExact($_.matches[0].Groups[2].Value, 'dd/MMM/yyyy:HH:mm:ss zzzz', $null)}}, @{"Name"="Method"; "Expression"={$_.matches[0].Groups[3]}}, @{"Name"="Path"; "Expression"={$_.matches[0].Groups[4]}}, @{"Name"="Version"; "Expression"={$_.matches[0].Groups[5]}}, @{"Name"="Status"; "Expression"={[int]($_.matches[0].Groups[6].Value)}}, @{"Name"="Size"; "Expression"={[int]($_.matches[0].Groups[7].Value)}}, @{"Name"="Referrer"; "Expression"={$_.matches[0].Groups[8]}}, @{"Name"="UserAgent"; Expression={$_.matches[0].Groups[9]}}